# 19. 배포 시스템

- HTTP 프로토콜을 기반으로 한 배포 기술인 FrontPage 와 DAV

## 19.1 배포 지원을 위한 FrontPage 서버 확장

- FrontPage(FP) : 다양한 기능을 제공하는 마이크로소프트사의 웹 개발 및 배포 도구 집합이다.
- 현재는 2003 버전을 마지막으로 개발을 중단

### 19.1.1 FrontPage 서버 확장

- "어디서든 배포한다"라는 전략의 하나로, 마이크로소프트는 FrontPage 서버 확장(`FrontPage Server Extensions, FPSE`)이라는 서버 측 소프트 웨어 제품군을 출시했다.
- 서버 측 컴포넌트는 **웹 서버와 통합**되어 웹 사이트와 FrontPage를 구동시키는 클라이언트(그리고 이 확장을 지원하는 다른 클라이언트) 사이에서 필요한 변환 작업을 수행한다.
- FP 클라이언트와 FPSE 사용하는 배포 프로토콜은 HTTP의 기본 의미를 바꾸지 않고서도 핵심 서비스에서 HTTP를 그대로 사용할 수 있게 함.
- FrontPage 배포 프로토콜은 HTTP POST 요청 위에 **RPC 계층**을 구현했다.
- POST 메소드 통신만 가능하다면 중간에 프락시 서버가 존재하더라도 괜찮.

### 19.1.2 FrontPage 용어

- `가상 서버` : 하나의 웹 서버에서 여러 개의 사이트를 호스팅
- `루트 웹` : 보통 웹 서버의 최상위 콘텐츠 디렉터리이거나 다중 호스팅 환경에서 가상 웹 서버의 최상위 콘텐츠 디렉터리이다.
    - 루트 웹에 접근하려면 페이지 명을 기술하지 않고 서버의 URL만 기술
    
           웹 서버에는 오직 한개의 루트 웹만 있다.
    
- `서브 웹` : 루트 웹의 하위 디렉터리이거나 완전한 FPSE 확장 웹인 다른 서브 웹의 하위디렉터리이다. 서브 웹은 관리나 저작의 권한을 자체적으로 제한하는 완전히 독립적인 엔터티가 될 수 있다. 또한, 서브 웹은 검색 범위의 단위로 사용할 수 있다.

### 19.1.3 FrontPage RPC 프로토콜

- FrontPage 클라이언트와 FPSE는 자체 `RPC` 프로토콜을 사용해 통신한다.
- 이 포로토콜은 RPC 메서드와 그와 관련한 변수를 POST 요청의 본문에 기술해서 HTTP POST를 감싼다.
- 클라이언트는 먼저 서버에 POST 요청을 실행시킬 수 있는 FPSE 패키지의이름을 알기 위해 특별한 GET 요청을 보내게 된다.

```tsx
GET /_vti_inf.html
```

- 다음 FrontPage 클라이언트는 응답을 읽고 `FPSShtmlScriptURl, AuthorScriptURl` 값을 읽어서 POST 요청을 보낼 위치를 클라이언트에게 알려줍니다.

**요청**

- `POST` 명령의 본문엔는 FPSE에 보내는 RPC 명령이 기술되어 있다.
- CGI 프로그램과 같이, 메서드 내의 빈칸은 더하기 문자로 인코딩 된다.
- 메서드 안에서 알파벳 외 문자는 모두 아스키 표현 으로 인코딩 된다.

```tsx
method=list+documents:4.0.1.3717
&service_name=
&listHiddenDocs=false
&listExplorerDocs=false
```

- `service_name` : 메서드가 수행되어야 하는 웹 사이트의 URL
- `listHiddenDocs` : 값이 true면 웹에 숨겨진 문서가 보인다.
- `listExploreDocs` : 값이 true면 태스크 리스트를 나열한다.

**응답**

- 웹 서버에서 유효한 문서의 목록을 특정 형식에 맞추어 작성해 FP 클라이언트에 반환한다.

### 19.1.4 FrontPage 보안 모델

- 대부분의 경우 FPSE의 보안은 웹 서버에 의존한다.
- FPSE 보안 모델은 사용자를 세 가지로 정의한다.
    - 모든 제어 권한을 가지고 있는 **관리자, 저작자,** 브라우징 하는 **일반 사용자**다.
- IIS가 아닌 서버의 웹 서버 접근 제어 메커니즘에서는, 주어진 프로그램에 접근할 수 있게 허가된 사용자들을 따로 기술한다.
- 아파치와 NCSA 웹 서버에서는 .htaccess 파일에 기술한다.
- 넷스케이프 서버에서는 .nsconfigdp에 기술한다.
- IIS 서버에서, 권한이 있는지에 대한 검사는 주어진 루트나 서브루트에 대한 ACL을 보고 검사한다.
- IIS가 요청을 받으면, 로그인하고 사용자로 가장한 다음, 세 개의 확장 동적 링크 라이브러리(DLL)중 하나에 요청을 보낸다.
- DLL은 목적지 폴더에 정의된 ACL을 기준으로 가장된 사용자가 권한이 있는지 검사한다.
- 검사에 성공하면 요청된 동작은 확장 DLL을 통해 실행된다.
    - 실패하면 승인 거부(permission Denied) 메시지 반환