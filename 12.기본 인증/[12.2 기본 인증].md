# 12-2. 기본 인증

## 1. 개요

- 기본 인증은 가장 잘 알려진 `HITTP 인증 규약`
- 거의 모든 주요 클라이언트와 서버에 기본 인증이 구현되어 있음
- 기본 인증은 원래 HTTP/1.0에 기술되어 있었지 만, HTTP 인증의 상세 내용을 다루는 RFC 2617로 옮겨짐
- 기본 인증에서, 웹 서버는 클라이언트의 요청을 거부하고 유효한 사용자 이름과 비밀번호를 요구할 수 있다.
  - `서버는 200 대신 401 상태 코드와 함께`, 클라이언트가 접근하려고 했던 보안 영역을 `WWW-Authenticate에 기술해서 응답`하여 인증요구를 시작
  - 인증 정보를 포함하여 요청하리는 응답을 받은 브라우저는, 사용자에rp 계정과 비밀번호를 입력할 수 있는 대화상자를 연다.
  - 여기서 rP정과 비밀번호는 사용자가 해당 영역에 접근 권한이 있는지 검사하는데 사용
  - 브라우저는 사용 자가 입력한 사용자 이름과 비밀번호를 Authorization 요청 헤더 안에 암호화해서 서버로 다시 보낸다.

## 2. 기본 인증의 예(12.2.1)

- 그림 12-2a에서는 사용자가 자신의 가족사진인 /family/jeff.jpg를 요청
- 그림 12-2b에서는 서버가 www-Authenicate 헤더와 함께 개인 가족사진에 접근하는 데 필요한 비밀번호를 요구하는 401 Authorization Required 응답을 반환 한다.
- 그림 12-2c에서는 브라우저가 401 응답을 받고 Family 영역에 관한 사용자 이름 과 비밀번호를 요구하는 대화상자를 띄운다. 사용자가 사용자 이름과 비밀번호 를 입력하면, 브라우저는 그것들을 콜론으로 이어 붙이고, base-64 방식으로 인코딩하고, Authorization 헤더에 그 값을 담아 서버로 다시 보낸다.
- 그림 12-24에서는 서버가 사용자 이름과 비밀번호를 디코딩하고, 그 값이 정확한지 검사한 후, 문제가 없으면 HTTP 200 OK 메시지와 함께 요청받았던 문서를 보낸다.

| 인증요구/ 응답                  | 헤더 문법과 설명                                                                                                                                                                                                                                   |
| ------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 인증요구(서버에서 클라이언트로) | 각 사이트는 보안 영역마다 다른 비밀번호가 있을 것이다. realm은 요청 받은 문서 지합의 이름을 따옴표로 감싼 것으로 사용자는 이 정보를 보고 어떤 비밀번호를 사용해야 하는지 알 수 있다 `WWW-Authenticate: Basic realm=따옴표로 감싼 문서 집합 정보`   |
| 응답(클라이언트에서 서버로)     | 사용자 이름과 비밀번호는 콜론으로 잇고 base-64로 인코딩해서 사용자 이름과 비밀번호에 쉽게 국제문자를 포함할 수 있게 하고 네트워크 트래픽에 사용자 이름과 비밀번호가 노출되지 않게 한다 `Authorization: Base-64 로 인코딩한 사용자 이름과 비밀번호` |

- `기본 인증 프로토콜은 Authentication-Info 헤더를 사용하지 않는다는 점` 기억!

## 2. Base-64 사용자 이름 / 비밀번호 인코딩(12.2.2)

- HTTP 기본 인증은 사용자 이름과 비밀번호를 콜론으로 이어서 합치고 base-64 인코딩 메서드를 사용해 인코딩
- base-64 인코딩은 8비트 바이트로 이루어져있는 시퀀스를 6비트 덩어리의 시퀀스로 변환
- 각 6비트 조각은 대부분 문자와 숫자로 이뤄진 특별한 64개의 문자 중 선택
- Base-64 인코딩은 바이너리, 텍스트, 국제 문자 데이터(어떤 시스템에서는 문제를 일으킬 수 있는) 문자열 받아서 전송할 수 있게, 그 문자열을 전송 가능한 문자인 알파벳으로 변환하기 위해 발명
- 전송 중에 원본 문자열이 변질될 걱정 없이 원격에서 디코딩할 수 있다.
- base-64 인코딩은 국제 문자나 HTTP 헤더에서 사용할 수 없는 문자(큰따옴표, 콜론, 캐리지 리턴)를 포함한 사용자 이름이나 비밀번호를 보내야 할 때 유용
- base-64는 어렵지 않게 사용자 이름과 비밀번호 문자를 섞을 수 있기 때문에, 서버나 네트워크를 관리하면서 뜻하지 않게 사용자 이름과 비밀번호가 노출되는 문제를 예방하는 데 도움

## 3. 프락시 인증(12.2.3)

- 중개 프락시 서버를 통해 인증할 수도 있음
- 어떤 회사는 사용자들이 회사의 서버나 LAN이나 무선 네트워크에 접근하기 전에 프락시 서버를 거치게 하여 사용자를 인증
- 프락시 서버에서 접근 정책을 중앙 관리 할 수 있기 때문에 회사 리소스 전체에 대해 통합적인 접근 제어를 하기 위해 프락시 서버를 사용하면 좋음
- 이 절차의 첫번째 단계는 프락시 인증으로 사용자를 식별
- 프락시 인증은 우베 서버의 인증과 헤더와 상태 코드만 다르고 절차는 같음
- 아래는 웹 서버와 프락시 인증에서 쓰이는 상태 코드와 헤더들의 대조표

| 웹 서버              | 프락시 서버              |
| -------------------- | ------------------------ |
| 비인증 상태 코드:401 | 비인증 상태 코드:407     |
| WWW-Authenticate     | Proxy-Authenticate       |
| Authorization        | Proxy-Authorization      |
| Authenticaton-info   | Proxy-Authenticaton-info |
