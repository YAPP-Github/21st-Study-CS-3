# 14.6 디지털 인증서

## 1. 개요

- `디지털 인증서`(흔히 certs라고 불리는) : 신뢰할 수 있는 기관으로부터 보증 받은 사용자나 회사에 대한 정보를 담고 있다

## 2. 인증서의 내부(14.6.1)

- `디지털 인증서`에는 또한 공식적으로 `‘인증 기관’에 의해 디지털 서명된 정보의 집합`이 담겨있다
- 기본적인 디지털 인증서는 보통 다음과 같이 인쇄된 ID에도 흔히 들어가게 되는 기본적인 것들을 담고 잇다
  - `대상의 이름`(사람, 서버, 조직 등)
  - `유효 기간`
  - `인증서 발급자` (누가 이 인증서를 보증하는가)
  - `인증서 발급자의 디지털 서명`
- `디지털 인증서`는 대상과 사용된 서명 알고리즘에 대한 서술적인 정보뿐 아니라 보통 대상의 공개키도 담고 있다
- 누구나 디지털 인증서를 만들 수 있지만 그 모두가 인증서의 정보를 보증하고 인증서를 개인 키로 서명할 수 있는 널리 인정받는 서명 권한을 얻을 수 있는 것은 아니다

## 3. X.509 v3 인증서

- 디지털 인증서에 대한 `전 세계적인 단일 표준은 없다`
- 모든 인쇄된 ID 카드가 같은 위치에 같은 정보를 담고 있지 않은 것처럼, 여러가지 미묘하게 다른 스타일의 디지털 인증서들이 존재한다
- 오늘날 사용되는 대부분의 인증서가 그들의 정보를 X.509 라 불리는 표준화된 서식에 저장하고 있다는 것
- X.509 v3 인증서는 인증 정보를 파싱 가능한 필드에 넣어 구조화하는 표준화된 방법을 제공
- 다른 종류의 인증서는 다른 필드 값을 가지지만 대부분은 X.509 v3 구조를 따른다
- X.509 인증서의 필드들

| 필드                     | 설명                                                                                                                                                                                                                                                                                                                   |
| ------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 버전                     | 이 인증서가 따르는 X.509 인증서 버전의 번호. 요즘은 보통 버전 3이다                                                                                                                                                                                                                                                    |
| 일련번호                 | 인증기관에 의해 생성된 고유한 정수. CA 로부터의 각 인증서는 반드시 고유한 일련 번호를 가져야 한다                                                                                                                                                                                                                      |
| 서명 알고리즘 ID         | 서명을 위해 사용된 암호 알고리즘. 예를 들면 “RSA 암호화를 이용한 MD2 요약”                                                                                                                                                                                                                                             |
| 인증서 발급자            | 인증서를 발급하고 서명한 기관의 이름. X.500 포맷으로 기록되어 있다                                                                                                                                                                                                                                                     |
| 유효기간                 | 인증서가 유효한 기간. 시작일과 종료일로 정의된다                                                                                                                                                                                                                                                                       |
| 대상의 이름              | 인증서에 기술된, 사람이나 조직과 같은 엔터티. 이 대상 이름은 X.500 포맷으로 기록되어 있다                                                                                                                                                                                                                              |
| 대상의 공개 키 정보      | 인증 대상의 공개 키, 공개 키에 사용된 알고리즘, 추가 매개변수.                                                                                                                                                                                                                                                         |
| 발급자의 고유 ID(선택적) | 발급자의 이름이 겹치는 경우를 대비한, 인증서 발급자에 대한 선택적인 고유한 식별자.                                                                                                                                                                                                                                     |
| 대상의 고유 ID(선택적)   | 대상의 이름이 겹치는 경우를 대비한, 인증 대상에 대한 선택적인 고유한 식별자.                                                                                                                                                                                                                                           |
| 확장                     | 선택적인 확장 필드의 집합(버전 3이상에서 지원). 각 확장 필드는 중요한 것인지 그렇지 않은지가 표시되어 있다. 중요한 확장은 중요하기 때문에 인증서 사용자에 의해 반드시 이해되어야 한다. 만약 인증서 사용자가 중요한 확장 필드를 이해하지 못한다면 인증서를 거절해야 한다. 흔히 쓰이는 확장들에는 다음과 같은 것이 있다. |

기본 제약: 대상과 인증기관과의 관계
인증서 정책: 인증서가 어떤 정책하에 승인되었는지
키 사용: 공개 키가 어떻게 사용될 수 있는지에 대한 제한 |
| 인증기관 서명 | 위의 모든 필드에 대한 인증기관의 디지털 서명. 명시된 서명 알고리즘을 사용한다 |

## 4. 서버 인증을 위해 인증서 사용하기(14.6.3)

- 사용자가 HTTPS를 통한 안전한 웹 트랜잭션을 시작할 때 최신 브라우저는 자동으로 접속한 서버에서 디지털 인증서를 가져온다
  - 만약, 서버가 인증서를 갖고 있지 않다면 보안 커넥션은 실패한다. 서버 인증서는 다음을 포함한 많은 필드를 갖고 있다.
    - `웹 사이트의 이름과 호스트 명`
    - `웹 사이트의 공개키`
    - `서명 기관의 이름`
    - `서명 기관의 서명`
- 브라우저가 인증서를 받으면 서명 기관을 검사한다
  - 만약 그 기관이 공공이 신뢰할만한 섬여 기관이라면 브라우저는 그것의 공개키를 이미 알고 있을 것이며(브라우저들은 여러 서명 기관의 인증서가 미리 설치된 채로 출하된다) 이전 절 “디지털 서명”에서 이야기했던 바와 같이 브라우저는 그 서명을 검증할 수 있다
- 인증서의 디지털 서명을 이용해 어떻게 그 인증서의 무결성을 검증하는지

  ![IMG_71652295C82D-1.jpeg](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/de80a2c0-97ba-45f1-b4ae-a124069f9ee0/IMG_71652295C82D-1.jpeg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230320%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230320T125235Z&X-Amz-Expires=86400&X-Amz-Signature=16a015acb70ca941c52b5f6d838a9776e0bbc0a2b1a8cf6a692c2262708b2805&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%22IMG_71652295C82D-1.jpeg%22&x-id=GetObject)

- 만약 서명 기관이 모르는 곳이라면, 브라우저는 그 서명 기관을 신뢰해야 할지 확신할 수 없으므로, 대개 사용자가 서명기관을 신뢰하는지 확인하기 위한 대화상자를 보여준다
- 서명 기관은 같은 사용자가 다니는 회사의 IT 부서이거나 혹은 소프트웨어 개발사일 수도 있을 것이다
