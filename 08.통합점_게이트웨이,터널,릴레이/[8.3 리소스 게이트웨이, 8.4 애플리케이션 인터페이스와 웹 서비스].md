# 8.3 리소스 게이트웨이

## 1. 개요

- 게이트웨이의 가장 일반적인 형태인 `애플리케이션 서버`는 `목적지 서버와 게이트웨이를 한 개의 서버로 결합`

  - `애플리케이션 서버`는 HTTP를 통해서 클라이언트와 통신하고 서버측에 있는 애플리케이션 프로그램에 연결하는 `서버 측 게이트웨이`
    ![출처: http 완벽가이드](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/4bfdd618-871d-41b7-a72e-f3179b7380e0/8%EC%9E%A5.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230114T224047Z&X-Amz-Expires=86400&X-Amz-Signature=6630a51a270e458929fdd1287140539f2cd107dbd2fad52a7bbe8a7214cedb93&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%228%25EC%259E%25A5.jpg%22&x-id=GetObject)
  - `두개의 클라이언트`가 `HTTP`를 사용하여 애플리케이션 서버로 연결
  - 서버로부터 파일이 전송되는 대신에, `애플리케이션 서버는 게이트웨이의 애플리케이션 프로그래밍 인터페이스(API)를 통해서 요청을 서버에서 동작하고 있는 애플리케이션에 전달`
  - 클라이언트 A의 요청을 받으면 그 요청의 URI 를 따라서 API를 통해 디지털 카메라 애플리케이션에 요청 전송. HTTP 응답 메시지는 최종 카메라 이미지를 감싸 클라이언트로 전송하고 클라이언트의 브라우저에 보인다
  - 클라이언트 B의 URI는 전자상거래 애플리케이션을 가리킴. 클라이언트 B의 요청은 서버 게이트웨이 API를 통해 전자상거래 소프트웨어로 전송되고 결과는 브라우저로 전송. 전자상거래 소프트웨어는 클라이언트와 통신하여 사용자가 순차적인 HTML 페이지를 통해 구매를 완료할 수 있도록 함.

- 애플리케이션 게이트웨이에서 유명했던 최초의 API는 `공용 게이트웨이 인터페이스(CGI)`
- CGI
  - 특정 `URL에 대한 HTTP 요청에 따라 프로그램을 실행`하고 `프로그램의 출력을 수집`하고 `HTTP 응답으로 회신하는데` 웹 서버가 사용하는 표준화된 인터페이스 집합

## 2. 공용 게이트웨이 인터페이스(8.3.1)

- 공용 게이트웨이 인터페이스(CGI)
  - 최초의 서버 확장. 지금까지도 가장 널리 쓰이는 서버 확장
  - 웹에서 동적인 HTML, 신용카드 처리, 데이터베이스 질의 등을 제공하는 데 사용
- CGI 애플리케이션이 서버와 분리되면서 펄(Perl), Tcl, C, 다양한 셸 언어를 포함하여 수많은 언어로 구현할 수 있게 되었다
- CGI는 단순하므로 거의 모든 HTTP 서버가 지원
- CGI가 내부에서 어떤 처리를 하는지는 사용자에게 보이지 않는다
  - 사용자의 시각에서는 CGI가 내부적으로 일반적인 요청을 만드는 것일 뿐
  - 서버와 CGI 애플리케이션간에 진행되는 처리 단계 감춤
- CGI는 거의 모든 리소스 형식과 서버의 접점에 있으면서 `필요에 따라 어떤 변형이든 처리해내는 단순한 기능` 제공
- 인터페이스는 문제가 많은 확장으로부터 서버를 보호한다는 점에서 훌륭하다고 할 수 있다
  - 이런 분리 때문에 `성능 관련한 비용` 발생
  - `모든 CGI 요청마다 새로운 프로세스를 만드는 데 따르는 부하가 꽤 크고` CGI를 사용하는 서버의 `성능을 제한하며 서버 장비에 부담`을 줌
- 이 문제를 피하고자 새로운 CGI형식인, `Fast CGI`가 개발
  - CGI와 유사하지만 데몬으로 동작함으로써 요청마다 `로운 프로세스를 만들고 제거`하면서 생기는 `성능 저하 문제 해결`

## 3. 서버 확장 API(8.3.2)

- CGI 프로토콜은 구동 중인 HTTP 서버에 외부 인터프리터가 쉽게 접속할 있게 해줌
- 서버자체의 동작을 바꾸고 싶거나 서버의 처리 능력을 최고치로 끌어올리고자 할 떄는?
  - 서버 개발자는 웹 개발자가 자신의 모듈을 HTTP와 직접 연결할 수 있는 `강력한 인터페이스인 서버 확장 API` 제공
  - `확장 API`는 `프로그래머가 자신의 코드를 서버에 연결하거나 서버의 컴포넌트를 자신이 만든 것으로 교체`해버릴 수 있게 함
- 유명한 서버 대부분은 개발자에게 확장 API를 한개 이상 제공
  - 이런 확장은 `서버 자체의 아키텍처에 의존하기 때문에 대부분 한가지 서버 형식`으로 특화됨
  - 마이크로소프트, 넷스케이프, 아파치 등 서버들은 `개발자가 서버의 동작을 변경하거나 다른 리소스에 대한 사용자 맞춤 인터페이스를 제공하는 데 쓸 수 있는 API`가짐
- 예
  - `프론트페이지(Front page) 제작자가 웹 출판 서비스를 하게 지원`해주는 마이크로소프트의 프론트페이지 서버확장(FPSE)
    - 프론트페이지 클라이언트로부터 전송되는 원격 프로시져 호출(RPC)명령을 인식할 수 있다. 이 명령은 HTTP에 편승하여 온다(HTTP POST 메서드상에 붙어서 온다) → 19장 “배포 지원을 위한 FrontPage 서버 확장” 참고

# 8.4 애플리케이션 인터페이스와 웹 서비스

- 애플리케이션을 연결하면서 생기는 까다로운 이슈 중 하나는 `데이터를 교환하려는 두 애플리케이션 사이에서 프로토콜 인터페이스를 맞추는 일`
- 애플리케이션이 상호운용을 하다보면 `HTTP 헤더로는 표현하기 힘든 복잡한 정보를 교환`해야 할 수도 있다
- 인터넷 커뮤니티는 각 웹 애플리케이션이 서로 통신하는데 사용할 `표준과 프로토콜 집합`을 개발하였다
  - 이러한 표준은 원래 웹 서비스가 독립형 웹 애플리케이션 그 자체를 의미함에도 불구하고 그냥 그대로 웹 서비스로 불리게 되었다
  - 웹 서비스가 새로운 용어는 아니지만 여기서 웹 서비스는 애플리케이션이 정보를 공유하는데 사용하는 `새로운 메커니즘` 의미
  - 웹 서비스는 `HTTP 같은 표준 웹 기술 위에서 개발`
- 웹 서비스는 `SOAP`을 통해 `XML`을 사용하여 정보 교환
  - `XML`
    - 데이터 객체를 담는 데이터를 생성하고 해석하는 방식을 제공
  - `SOAP`
    - HTTP 메시지에 XML 데이터를 담는 방식에 관한 표준
